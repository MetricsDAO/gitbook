# Segment 2

## Overview

The second segment will expand on topics learned in the previous week: using aggregation functions across date ranges or categories with `GROUP BY`.

We discuss using visualizations while you're working as a tool to source information and insight for your next steps. Some techniques on cleaning up outlier groups with `CASE` statements, and why we might want to do something like this over excluding small figures.

Beyond that, we dove into extracting data from other tables and how to use those alongside our queries with `JOINS` and ordering data steps with `CTE`s.

The broader message structure, as seen on Etherscan and in the `fact` tables, was introduced. As well as the steps that Flipside's data models take to create the `ez` models with their beautifully clean data (like the [`ez_dex_swaps`](https://flipsidecrypto.github.io/ethereum-models/#!/model/model.ethereum\_models.core\_\_ez\_dex\_swaps?g\_v=1\&g\_i=%2Bcore\_\_ez\_dex\_swaps%2B) or [`ez_nft_sales`](https://flipsidecrypto.github.io/ethereum-models/#!/model/model.ethereum\_models.core\_\_ez\_nft\_sales?g\_v=1\&g\_i=%2Bcore\_\_ez\_nft\_sales%2B) DAGs) and how those relate to Joins and CTEs within your own queries.

## Recording

{% embed url="https://www.youtube.com/watch?v=OAxQ-pOFf_E" %}

## SQL Topics Covered:

* GROUP BY
  * HAVING
* DATE\_TRUNC
* CASE Statements
* Common Table Expressions (CTEs)
* JOIN





